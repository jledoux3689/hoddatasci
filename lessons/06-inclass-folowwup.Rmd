---
title: "Inclas"
output: html_document
---

In Class Work: Scatterplots
-----------------------------

Complete the following steps using the `cex.Rdata` file:

```{r}
library(tidyverse)
library(modelr)

load("cex.Rdata")
```


1. Plot dining out as a function of income percentile rank. 
```{r}
gg<-ggplot(data=cex,aes(x=inc_rank,y=dine_out+1))
gg<-gg+geom_point()
gg

```



2. Add a line of best fit to the above graphic. 

```{r}
gg<-gg+geom_smooth(method="lm")
gg
```

3. Now create a plot with a scale appropriate to dining out as the dependent variable. 

```{r}
gg<-gg+scale_y_continuous(trans="log",breaks=c(100,500,1000,2000,5000,10000))
gg

```


4. Add a line of best fit to your new graphic.


5. Create another plot with dining out on the y axis, income percentile rank on the x axis, and a categorical (factor) variable that differentiates the points. 


```{r}
gg<-ggplot(data=cex,aes(x=inc_rank,y=dine_out+1,color=sex_ref))
gg<-gg+geom_point()
gg
```

6. Run a regression that has (possibly transformed) dining out out as the dependent variable, with income and at least one other variable as predictors. What's the RMSE from this model (relative to the testing dataset)?

```{r}
load("cex_train.Rdata")

mod1<-lm(log(dine_out+1)~
           inc_rank+
           as.factor(sex_ref),
         data=cex_train)

load("cex_test.Rdata")


modelr::rmse(mod1,cex_test)

```


7. Create new predictions from your model. 
8. Create a plot showing predicted levels of dining out based on income and your other variable from the model in number 6. 

```{r}
h_data<-cex%>%data_grid(inc_rank=seq_range(inc_rank,n=100),
                        sex_ref=c(1,2))

h_data<-h_data%>%add_predictions(mod1,h_data)



```



9. Make your plot beautiful in every way. Make sure that axes are labeled appropriately, that colors are used well, and that legends help the reader to make sense of the plot. 
